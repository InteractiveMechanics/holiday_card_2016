var ImagePainter=function(a){this.image=new Image,this.image.src=a};ImagePainter.prototype={image:void 0,paint:function(a,b){void 0!==this.image&&(this.image.complete?b.drawImage(this.image,a.left,a.top,a.width,a.height):this.image.onload=function(c){a.width=this.width,a.height=this.height,b.drawImage(this,a.left,a.top,a.width,a.height)})}};var SpriteSheetPainter=function(a,b){this.image=new Image,this.image.src=a,this.cells=b};SpriteSheetPainter.prototype={cells:[],cellIndex:0,image:void 0,advance:function(){this.cellIndex==this.cells.length-1?this.cellIndex=0:this.cellIndex++},paint:function(a,b){var c=this.cells[this.cellIndex];b.drawImage(this.image,2*c.left,2*c.top,2*c.width,2*c.height,a.left,a.top,c.width,c.height)}};var SpriteAnimator=function(a,b){this.painters=a,b&&(this.elapsedCallback=b)};SpriteAnimator.prototype={painters:[],duration:1e3,startTime:0,index:0,elapsedCallback:void 0,end:function(a,b){a.animating=!1,this.elapsedCallback?this.elapsedCallback(a):a.painter=b},start:function(a,b){var c=+new Date+b,d=b/this.painters.length,e=void 0,f=this,g=a.painter;this.index=0,a.animating=!0,a.painter=this.painters[this.index],e=setInterval(function(){+new Date<c?a.painter=f.painters[++f.index]:(f.end(a,g),clearInterval(e))},d)}};var Sprite=function(a,b,c){return void 0!==a&&(this.name=a),void 0!==b&&(this.painter=b),void 0!==c&&(this.behaviors=c),this};Sprite.prototype={left:0,top:0,width:10,height:10,velocityX:0,velocityY:0,visible:!0,animating:!1,painter:void 0,behaviors:[],paint:function(a,b){void 0!==this.painter&&this.visible&&this.painter.paint(this,a,b)},update:function(a,b){for(var c=this.behaviors.length;c>0;--c)this.behaviors[c-1].execute(this,a,b)}};